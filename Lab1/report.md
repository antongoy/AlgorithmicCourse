Лабораторная работа №1. "Поиск пары ближайших точек".
=====================================================

### Отчет студента 617 группы Гоя Антона.

#### Постановка задачи

**Дано:** Множество точек на плоскости $P = \{  p_1, p_2, \dots, p_N \}$,  $p_i = (x_i, y_i) \in \mathbb{R}^2$.
**Найти:** Пару точек $p', p'' \in P$, расстояние между которыми минимально. В качестве расстояния рассматривается обычное евклидово расстояние $d(p', p'') = \sqrt{(x' - x'')^2 + (y' - y'')^2}$.

#### Наивное решение

Очевидно, что данную задачу можно решить простым перебором всех пар точек (подход brute force). Но данный подход не смотря на свою простоту имеет сложность порядка $O(N^2)$, что является абсолютно неприемлемо, если $N$ порядка $10^7-10^8$.

#### Решение методом "разделяй и властвуй"

В ходе выполнения данной лабораторной работы для решения поставленной задачи был реализован эффективный алогритм поиска ближайших точек на плоскости, который имеет асимптотическую сложность $O(N \log N)$, где $N$ - количество точек. Принцип работы этого алгоритма можно описать с помощью преведенного ниже псевдокода.

> **Input:** множество $P$
> **Output:** пара точек $p', p'' \in P$
> 
> Подготовить массивы $X$ и $Y$. 
>> $X$ - отсортированные по координате $x$ точки из $P$
>> $Y$ - отсортированные по координате $y$ точки из $P$

> ***function*** find_nearest_points($P$, $X$, $Y$) -> $p', p''$ 
>> ***if***  $\left| P \right| \le3$ ***then*** 
>>> Перебором найти $p', p''$ 
>>> ***return*** $p', p''$ 

>> - Найти прямую $l$, которая делит множество $P$ на две равные части $P_L, P_R$.

>> - Разбить $X$ на массивы $X_L, X_R$, которые содержат точки из $P_L, P_R$ соответственно отсортированные в порядке возрастания координаты $x$

>> - Разбить $Y$ на массивы $Y_L, Y_R$, которые содержат точки из $P_L, P_R$ соответственно отсортированные в порядке возрастания координаты $y$

>> - $p_L', p_L''$ =  find_nearest_points($P_L$, $X_L$, $Y_L$)
>> - $p_R', p_R''$ =  find_nearest_points($P_R$, $X_R$, $Y_R$)

>> - $\delta_L = \| p_L' - p_L'' \|$, $\delta_R = \| p_R' - p_R'' \|$

>> - $\delta = \min(\delta_L, \delta_R)$

>> - Создать массив $Y'$ путем удаления из $Y$ точек, которые лежат вне полосы шириной $2\delta$, центром которой является прямая $l$

>> - ***for*** $p \in Y'$ ***do***
>>> Рассмотреть 7 точек, которые расположены после точки $p$ в массиве $Y'$,  отслеживая минимальное расстояние $\delta'$

>> - Пусть $p', p''$ точки расположенные в полосе шириной $2\delta$ расстояние между которыми минимально и равно $\delta'$

>> - ***if*** $\delta' < \delta$ ***then***
>>> ***return*** $p', p''$ 

>> - ***else***
>>> ***return*** пара точек, которая соответствует расстоянию $\delta$ (либо $p_L', p_L''$ , либо $p_R', p_R''$ )

Реализован данный алгоритм был на языке C++. В качестве алгоритма предварительной сортировки был реализован алгоритм сортровки слиянием. 

#### Инструкция по работе с программой

***Путь для исполняемого файла:*** `build/Release/Lab1`
***Файлы с исходным кодом*** расположены в директории `src/`

Программа запускается следующим образом: 

`$ ./Lab1 --input_file <имя_файла_с_входными данными>`

Вместо ключа `--input_file` можно использовать более короткую версию: `-i`: 

 `$ ./Lab1 -i <имя_файла_с_входными данными>`

Также в программе предусмотрен  вывод  решения, сделанного полным перебором, что полезно для отладки. Чтобы активировать эту функцию, необходимо передать в программу ключ `-bf` или `--brute_force`

 `$ ./Lab1 -i <имя_файла_с_входными данными> -bf` 